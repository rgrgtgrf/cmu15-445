with pid as (select person_id from people where born = 1955), tid as(select c.title_id, c.person_id from crew as c join titles as t where t.title_id = c.title_id and c.person_id in (select person_id from pid) and t.type = 'movie'), sortid as (select AVG(r.rating) as av, person_id from ratings as r join tid on tid.title_id = r.title_id group by person_id order by av desc), rankid as (select p.name, av, NTILE(10) over (order by av desc) as rk from sortid join people as p on p.person_id = sortid.person_id) select name, round(av, 2) as a from rankid where rk = 9;
